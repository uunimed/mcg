<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>სმარტ პროდუქტების სკანერი | საქართველო</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/@ericblade/quagga2/dist/quagga.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            position: relative;
        }
        
        /* Yuka-style header */
        .yuka-header {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .yuka-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: float 20s linear infinite;
        }
        
        @keyframes float {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .logo-container {
            position: relative;
            z-index: 2;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .logo-icon i {
            font-size: 28px;
            color: #4CAF50;
        }
        
        .logo h1 {
            font-size: 28px;
            font-weight: 800;
            letter-spacing: -0.5px;
        }
        
        .tagline {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 500;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }
        
        .status-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 2;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            min-height: 650px;
        }
        
        .scanner-section {
            flex: 1;
            min-width: 400px;
            background: #f8f9fa;
            padding: 30px;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .scanner-title {
            font-size: 22px;
            margin-bottom: 25px;
            color: #2E7D32;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
        }
        
        /* High Quality Scanner Container */
        .scanner-container {
            position: relative;
            width: 100%;
            height: 380px;
            margin: 0 auto;
            background: #000;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
            flex-grow: 1;
            border: 4px solid #4CAF50;
        }
        
        #interactive {
            width: 100%;
            height: 100%;
            display: block;
            object-fit: cover;
            filter: brightness(1.1) contrast(1.1);
        }
        
        /* Enhanced Scanner Overlay */
        .scanner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }
        
        .scanner-frame {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 85%;
            height: 140px;
            border: 4px solid #4CAF50;
            border-radius: 15px;
            box-shadow: 
                0 0 0 1000px rgba(0, 0, 0, 0.7),
                0 0 30px rgba(76, 175, 80, 0.8),
                inset 0 0 30px rgba(76, 175, 80, 0.8);
            animation: frameGlow 2s infinite alternate;
        }
        
        @keyframes frameGlow {
            0% { box-shadow: 
                0 0 0 1000px rgba(0, 0, 0, 0.7),
                0 0 30px rgba(76, 175, 80, 0.8),
                inset 0 0 30px rgba(76, 175, 80, 0.8); }
            100% { box-shadow: 
                0 0 0 1000px rgba(0, 0, 0, 0.7),
                0 0 40px rgba(76, 175, 80, 1),
                inset 0 0 40px rgba(76, 175, 80, 1); }
        }
        
        .scanner-line {
            position: absolute;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, transparent, #4CAF50, transparent);
            animation: scan 1.8s infinite linear;
            box-shadow: 0 0 20px #4CAF50;
            z-index: 10;
            border-radius: 3px;
        }
        
        @keyframes scan {
            0% { top: 10%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 90%; opacity: 0; }
        }
        
        .scanner-corners {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .corner {
            position: absolute;
            width: 30px;
            height: 30px;
            border-color: #4CAF50;
            border-style: solid;
        }
        
        .corner-tl {
            top: -4px;
            left: -4px;
            border-width: 6px 0 0 6px;
            border-radius: 15px 0 0 0;
        }
        
        .corner-tr {
            top: -4px;
            right: -4px;
            border-width: 6px 6px 0 0;
            border-radius: 0 15px 0 0;
        }
        
        .corner-bl {
            bottom: -4px;
            left: -4px;
            border-width: 0 0 6px 6px;
            border-radius: 0 0 0 15px;
        }
        
        .corner-br {
            bottom: -4px;
            right: -4px;
            border-width: 0 6px 6px 0;
            border-radius: 0 0 15px 0;
        }
        
        .scan-notification {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 700;
            display: none;
            z-index: 100;
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.4);
            font-size: 16px;
            animation: notificationPop 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        
        @keyframes notificationPop {
            0% { transform: translateX(-50%) scale(0); opacity: 0; }
            80% { transform: translateX(-50%) scale(1.1); }
            100% { transform: translateX(-50%) scale(1); opacity: 1; }
        }
        
        .scanner-instructions {
            text-align: center;
            margin-top: 25px;
            color: #555;
            font-size: 16px;
            background: rgba(76, 175, 80, 0.1);
            padding: 15px;
            border-radius: 12px;
            border-left: 5px solid #4CAF50;
            line-height: 1.6;
        }
        
        .scanner-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .yuka-button {
            padding: 16px 32px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            min-width: 180px;
            justify-content: center;
        }
        
        .yuka-button.primary {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
        }
        
        .yuka-button.secondary {
            background: linear-gradient(135deg, #2196F3, #1565C0);
            color: white;
        }
        
        .yuka-button.danger {
            background: linear-gradient(135deg, #f44336, #c62828);
            color: white;
        }
        
        .yuka-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
        }
        
        .yuka-button:active {
            transform: translateY(-2px);
        }
        
        .yuka-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .product-section {
            flex: 1.5;
            min-width: 400px;
            padding: 30px;
            display: flex;
            flex-direction: column;
            background: white;
            overflow-y: auto;
        }
        
        .product-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #757575;
            text-align: center;
            padding: 50px 30px;
            background: #f8f9fa;
            border-radius: 20px;
            border: 3px dashed #ddd;
        }
        
        .placeholder-icon {
            font-size: 80px;
            margin-bottom: 30px;
            color: #bdbdbd;
            animation: bounce 3s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        .placeholder-title {
            font-size: 24px;
            margin-bottom: 15px;
            color: #424242;
            font-weight: 700;
        }
        
        .placeholder-text {
            font-size: 16px;
            line-height: 1.6;
            max-width: 400px;
            color: #666;
        }
        
        /* Yuka-style Product Display */
        .product-info {
            display: none;
            height: 100%;
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .product-header {
            background: linear-gradient(135deg, #f8f9fa, #e8f5e9);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }
        
        .product-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 8px;
            height: 100%;
            background: linear-gradient(to bottom, #4CAF50, #2E7D32);
        }
        
        .product-image-container {
            display: flex;
            align-items: center;
            gap: 25px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .product-image {
            width: 140px;
            height: 140px;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
            flex-shrink: 0;
            border: 4px solid white;
            position: relative;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }
        
        .product-image:hover img {
            transform: scale(1.1);
        }
        
        .product-basic {
            flex: 1;
            min-width: 250px;
        }
        
        .product-title {
            font-size: 26px;
            color: #1a237e;
            margin-bottom: 10px;
            line-height: 1.3;
            font-weight: 800;
        }
        
        .product-brand {
            font-size: 18px;
            color: #4CAF50;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .barcode-display {
            background: rgba(76, 175, 80, 0.1);
            padding: 12px 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            color: #1a237e;
            display: inline-block;
            margin-bottom: 20px;
            border-left: 5px solid #4CAF50;
            font-weight: 700;
            letter-spacing: 2px;
        }
        
        .nutri-score-container {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .nutri-score {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 900;
            color: white;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        
        .score-a { background: linear-gradient(135deg, #4CAF50, #2E7D32); }
        .score-b { background: linear-gradient(135deg, #8BC34A, #689F38); }
        .score-c { background: linear-gradient(135deg, #FFC107, #FFA000); }
        .score-d { background: linear-gradient(135deg, #FF9800, #F57C00); }
        .score-e { background: linear-gradient(135deg, #f44336, #c62828); }
        
        .score-label {
            font-size: 16px;
            color: #555;
            font-weight: 600;
            max-width: 200px;
        }
        
        /* Alternatives Section */
        .alternatives-section {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }
        
        .section-title {
            font-size: 22px;
            color: #1565C0;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 800;
        }
        
        .alternatives-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }
        
        .alternative-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        .alternative-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 25px rgba(0,0,0,0.15);
        }
        
        .alternative-image {
            width: 100%;
            height: 120px;
            overflow: hidden;
        }
        
        .alternative-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .alternative-info {
            padding: 15px;
        }
        
        .alternative-name {
            font-size: 14px;
            font-weight: 700;
            color: #1a237e;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .alternative-score {
            font-size: 12px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 20px;
            display: inline-block;
        }
        
        /* Product Details */
        .product-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .detail-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
            border: 2px solid #f0f0f0;
            transition: transform 0.3s;
        }
        
        .detail-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.12);
        }
        
        .detail-card h3 {
            font-size: 20px;
            color: #1a237e;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 12px;
            border-bottom: 3px solid #4CAF50;
            font-weight: 800;
        }
        
        .ingredients-list {
            list-style-type: none;
        }
        
        .ingredient-item {
            padding: 12px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
        }
        
        .ingredient-item:hover {
            background: rgba(76, 175, 80, 0.05);
            border-radius: 8px;
            padding-left: 10px;
            padding-right: 10px;
        }
        
        .ingredient-status {
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 800;
            min-width: 70px;
            text-align: center;
        }
        
        .status-excellent {
            background: rgba(76, 175, 80, 0.15);
            color: #2E7D32;
            border: 2px solid #4CAF50;
        }
        
        .status-good {
            background: rgba(139, 195, 74, 0.15);
            color: #558B2F;
            border: 2px solid #8BC34A;
        }
        
        .status-medium {
            background: rgba(255, 193, 7, 0.15);
            color: #FF8F00;
            border: 2px solid #FFC107;
        }
        
        .status-bad {
            background: rgba(244, 67, 54, 0.15);
            color: #c62828;
            border: 2px solid #f44336;
        }
        
        .nutrition-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 10px;
        }
        
        .nutrition-item {
            background: linear-gradient(135deg, #f8f9fa, #e8e8e8);
            border-radius: 12px;
            padding: 20px 15px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .nutrition-item:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
        }
        
        .nutrition-value {
            font-size: 24px;
            font-weight: 900;
            color: #1a237e;
            margin-bottom: 5px;
        }
        
        .nutrition-label {
            font-size: 13px;
            color: #666;
            font-weight: 700;
        }
        
        .product-actions {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .action-button {
            flex: 1;
            min-width: 150px;
            padding: 18px 25px;
            border-radius: 15px;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            border: none;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .action-button.save {
            background: linear-gradient(135deg, #2196F3, #1565C0);
            color: white;
        }
        
        .action-button.buy {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
        }
        
        .action-button.compare {
            background: linear-gradient(135deg, #9C27B0, #7B1FA2);
            color: white;
        }
        
        .action-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            display: none;
        }
        
        .yuka-spinner {
            width: 100px;
            height: 100px;
            position: relative;
            margin-bottom: 30px;
        }
        
        .yuka-spinner::before,
        .yuka-spinner::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            animation: yukaSpin 2s linear infinite;
        }
        
        .yuka-spinner::before {
            width: 100%;
            height: 100%;
            border: 10px solid rgba(76, 175, 80, 0.1);
            border-top: 10px solid #4CAF50;
        }
        
        .yuka-spinner::after {
            width: 70%;
            height: 70%;
            top: 15%;
            left: 15%;
            border: 8px solid rgba(33, 150, 243, 0.1);
            border-top: 8px solid #2196F3;
            animation-delay: 0.5s;
        }
        
        @keyframes yukaSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: white;
            font-size: 22px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .sources-badge {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .source-tag {
            background: rgba(255,255,255,0.15);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        footer {
            background: linear-gradient(135deg, #1a237e, #283593);
            color: white;
            padding: 25px 30px;
            text-align: center;
            font-size: 15px;
        }
        
        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .footer-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
            color: #4CAF50;
        }
        
        .footer-text {
            opacity: 0.9;
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }
            
            .scanner-section {
                min-width: 100%;
            }
            
            .scanner-container {
                height: 320px;
            }
            
            .product-section {
                min-width: 100%;
            }
        }
        
        @media (max-width: 600px) {
            .yuka-header {
                padding: 20px 15px;
            }
            
            .logo h1 {
                font-size: 24px;
            }
            
            .scanner-container {
                height: 280px;
            }
            
            .scanner-title {
                font-size: 20px;
            }
            
            .product-title {
                font-size: 22px;
            }
            
            .yuka-button {
                min-width: 150px;
                padding: 14px 25px;
            }
        }
        
        /* Sound & Vibration Effects */
        .vibration-effect {
            animation: vibrate 0.3s linear;
        }
        
        @keyframes vibrate {
            0% { transform: translate(0); }
            20% { transform: translate(-3px, 3px); }
            40% { transform: translate(-3px, -3px); }
            60% { transform: translate(3px, 3px); }
            80% { transform: translate(3px, -3px); }
            100% { transform: translate(0); }
        }
        
        .sound-wave {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 4px;
            height: 40px;
            opacity: 0;
            z-index: 10;
        }
        
        .sound-wave.active {
            animation: soundPulse 0.5s ease-out;
        }
        
        .sound-bar {
            width: 6px;
            background: linear-gradient(to top, #4CAF50, #8BC34A);
            border-radius: 3px;
        }
        
        @keyframes soundPulse {
            0% { opacity: 0; transform: translateX(-50%) scale(0.5); }
            50% { opacity: 1; transform: translateX(-50%) scale(1); }
            100% { opacity: 0; transform: translateX(-50%) scale(0.5); }
        }
        
        /* Georgian Flag Colors */
        .georgian-flag {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, 
                #ff0000 33%, 
                #ffffff 33%, 
                #ffffff 66%, 
                #ff0000 66%);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 2;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Yuka-style Header -->
        <div class="yuka-header">
            <div class="georgian-flag"></div>
            <div class="logo-container">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-apple-alt"></i>
                    </div>
                    <h1>სმარტ პროდუქტების სკანერი</h1>
                </div>
                <p class="tagline">სკანირება ნებისმიერი შეფუთვის, მიიღეთ დეტალური ინფორმაცია და ჯანსაღი ალტერნატივები</p>
            </div>
            <div class="status-badge">
                <i class="fas fa-circle"></i>
                <span id="scannerStatusText">სკანერი გამორთულია</span>
            </div>
        </div>
        
        <div class="main-content">
            <!-- Scanner Section -->
            <div class="scanner-section">
                <h2 class="scanner-title">
                    <i class="fas fa-camera"></i>
                    მაღალი ხარისხის სკანერი
                </h2>
                
                <div class="scan-notification" id="scanNotification">
                    <i class="fas fa-check-circle"></i> შეფუთვა აღმოჩენილია!
                </div>
                
                <!-- High Quality Scanner -->
                <div class="scanner-container">
                    <div id="interactive" class="viewport"></div>
                    <div class="scanner-overlay">
                        <div class="scanner-frame">
                            <div class="scanner-line"></div>
                            <div class="scanner-corners">
                                <div class="corner corner-tl"></div>
                                <div class="corner corner-tr"></div>
                                <div class="corner corner-bl"></div>
                                <div class="corner corner-br"></div>
                            </div>
                        </div>
                    </div>
                    <div class="sound-wave" id="soundWave">
                        <div class="sound-bar" style="height: 25px;"></div>
                        <div class="sound-bar" style="height: 35px;"></div>
                        <div class="sound-bar" style="height: 30px;"></div>
                        <div class="sound-bar" style="height: 40px;"></div>
                        <div class="sound-bar" style="height: 35px;"></div>
                    </div>
                </div>
                
                <p class="scanner-instructions">
                    <i class="fas fa-lightbulb"></i> მიამაგრეთ კამერა ნებისმიერი პროდუქტის შეფუთვასთან. სკანირება მყისიერია, ხმოვანი და ვიბრაციული უკუკავშირით.
                </p>
                
                <div class="scanner-controls">
                    <button class="yuka-button primary" id="startScannerBtn">
                        <i class="fas fa-play"></i> სკანერის გაშვება
                    </button>
                    <button class="yuka-button danger" id="stopScannerBtn" disabled>
                        <i class="fas fa-stop"></i> გაჩერება
                    </button>
                    <button class="yuka-button secondary" id="testScanBtn">
                        <i class="fas fa-vial"></i> ტესტური სკანირება
                    </button>
                </div>
            </div>
            
            <!-- Product Information Section -->
            <div class="product-section">
                <div class="product-placeholder" id="productPlaceholder">
                    <div class="placeholder-icon">
                        <i class="fas fa-barcode"></i>
                    </div>
                    <h3 class="placeholder-title">მზად ხართ სკანირებისთვის!</h3>
                    <p class="placeholder-text">მიამაგრეთ კამერა ნებისმიერი პროდუქტის შეფუთვასთან საქართველოში გავრცელებული პროდუქტების შესახებ ინფორმაციის მისაღებად</p>
                    <p class="placeholder-text">პროდუქტის მონაცემები მოდის საქართველოს სუპერმარკეტების და ადგილობრივი ბაზრების მონაცემთა ბაზებიდან</p>
                </div>
                
                <div class="product-info" id="productInfo">
                    <!-- Product Header -->
                    <div class="product-header">
                        <div class="product-image-container">
                            <div class="product-image">
                                <img id="productImage" src="" alt="პროდუქტის სურათი">
                            </div>
                            <div class="product-basic">
                                <h1 class="product-title" id="productTitle">პროდუქტის დასახელება</h1>
                                <div class="product-brand" id="productBrand">ბრენდი</div>
                                <div class="barcode-display" id="barcodeDisplay">შეფუთვის კოდი: 123456789</div>
                                
                                <div class="nutri-score-container">
                                    <div class="nutri-score score-a" id="nutriScore">A</div>
                                    <div class="score-label" id="scoreLabel">შეფასება: ბევრად უკეთესი</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Alternatives Section -->
                    <div class="alternatives-section" id="alternativesSection">
                        <h3 class="section-title">
                            <i class="fas fa-exchange-alt"></i>
                            ჯანსაღი ალტერნატივები
                        </h3>
                        <div class="alternatives-grid" id="alternativesGrid">
                            <!-- Alternatives will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Product Details -->
                    <div class="product-details">
                        <div class="detail-card">
                            <h3><i class="fas fa-list-ul"></i> შემადგენლობა</h3>
                            <ul class="ingredients-list" id="ingredientsList">
                                <li class="ingredient-item">პროდუქტის სკანირება შემადგენლობის სანახავად</li>
                            </ul>
                        </div>
                        
                        <div class="detail-card">
                            <h3><i class="fas fa-thumbs-up"></i> დადებითი მხარეები</h3>
                            <ul class="ingredients-list" id="goodSidesList">
                                <li class="ingredient-item">პროდუქტის სკანირება დადებითი მხარეების სანახავად</li>
                            </ul>
                        </div>
                        
                        <div class="detail-card">
                            <h3><i class="fas fa-thumbs-down"></i> უარყოფითი მხარეები</h3>
                            <ul class="ingredients-list" id="badSidesList">
                                <li class="ingredient-item">პროდუქტის სკანირება უარყოფითი მხარეების სანახავად</li>
                            </ul>
                        </div>
                        
                        <div class="detail-card">
                            <h3><i class="fas fa-chart-pie"></i> საკვები ღირებულება (100გრ)</h3>
                            <div class="nutrition-grid" id="nutritionGrid">
                                <div class="nutrition-item">
                                    <div class="nutrition-value" id="caloriesValue">--</div>
                                    <div class="nutrition-label">კალორიები</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value" id="proteinValue">--</div>
                                    <div class="nutrition-label">ცილა</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value" id="carbsValue">--</div>
                                    <div class="nutrition-label">ნახშირწყლები</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value" id="fatValue">--</div>
                                    <div class="nutrition-label">ცხიმი</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="product-actions">
                        <button class="action-button save" id="saveProductBtn">
                            <i class="fas fa-bookmark"></i> შენახვა
                        </button>
                        <button class="action-button buy" id="buyProductBtn">
                            <i class="fas fa-store"></i> ყიდვა საქართველოში
                        </button>
                        <button class="action-button compare" id="compareProductBtn">
                            <i class="fas fa-balance-scale"></i> შედარება
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <div class="footer-title">
                    <i class="fas fa-flag"></i> მხოლოდ საქართველოსთვის
                </div>
                <p class="footer-text">ეს აპლიკაცია შექმნილია სპეციალურად საქართველოში გავრცელებული პროდუქტებისთვის</p>
                <p class="footer-text">მონაცემები მოდის ადგილობრივი სუპერმარკეტების, ნიკორას, სპარის, ელიტელის და სხვა ქართული ბრენდების ბაზებიდან</p>
            </div>
        </footer>
    </div>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="yuka-spinner"></div>
        <div class="loading-text" id="loadingText">პროდუქტის ინფორმაციის მოძიება...</div>
        <div class="sources-badge">
            <div class="source-tag"><i class="fas fa-store"></i> ნიკორა</div>
            <div class="source-tag"><i class="fas fa-shopping-cart"></i> სპარი</div>
            <div class="source-tag"><i class="fas fa-leaf"></i> ელიტელი</div>
            <div class="source-tag"><i class="fas fa-utensils"></i> ქართული პროდუქტები</div>
        </div>
    </div>

    <script>
        // DOM Elements
        const startScannerBtn = document.getElementById('startScannerBtn');
        const stopScannerBtn = document.getElementById('stopScannerBtn');
        const testScanBtn = document.getElementById('testScanBtn');
        const scannerStatusText = document.getElementById('scannerStatusText');
        const scanNotification = document.getElementById('scanNotification');
        const soundWave = document.getElementById('soundWave');
        const productPlaceholder = document.getElementById('productPlaceholder');
        const productInfo = document.getElementById('productInfo');
        const productTitle = document.getElementById('productTitle');
        const productBrand = document.getElementById('productBrand');
        const productImage = document.getElementById('productImage');
        const barcodeDisplay = document.getElementById('barcodeDisplay');
        const nutriScore = document.getElementById('nutriScore');
        const scoreLabel = document.getElementById('scoreLabel');
        const ingredientsList = document.getElementById('ingredientsList');
        const goodSidesList = document.getElementById('goodSidesList');
        const badSidesList = document.getElementById('badSidesList');
        const nutritionGrid = document.getElementById('nutritionGrid');
        const alternativesSection = document.getElementById('alternativesSection');
        const alternativesGrid = document.getElementById('alternativesGrid');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const loadingText = document.getElementById('loadingText');
        const saveProductBtn = document.getElementById('saveProductBtn');
        const buyProductBtn = document.getElementById('buyProductBtn');
        const compareProductBtn = document.getElementById('compareProductBtn');
        
        // Variables
        let scannerActive = false;
        let currentBarcode = null;
        let lastScannedCode = null;
        let scanCooldown = false;
        let audioContext;
        
        // Georgian Products Database (საქართველოს პროდუქტები)
        const georgianProducts = {
            // Georgian Water and Beverages
            '4860103210011': {
                name: "ნაბეღლავი წყალი",
                brand: "ნაბეღლავი",
                image: "https://images.unsplash.com/photo-1523362628745-0c100150b504?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80",
                category: "სასმელი",
                ingredients: ["ბუნებრივი მინერალური წყალი"],
                goodSides: ["ბუნებრივი მინერალები", "კალციუმის წყარო", "არ შეიცავს შაქარს"],
                badSides: [],
                nutrition: { calories: 0, protein: 0, carbs: 0, sugar: 0, fat: 0, salt: 0.01 },
                score: "A",
                alternatives: [
                    { name: "ბორჯომი", score: "A", image: "https://images.unsplash.com/photo-1523362628745-0c100150b504?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ლიკანი", score: "A", image: "https://images.unsplash.com/photo-1523362628745-0c100150b504?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "საბადურო", score: "A", image: "https://images.unsplash.com/photo-1523362628745-0c100150b504?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" }
                ]
            },
            
            // Georgian Dairy Products
            '4860103220010': {
                name: "დარიჩინის რძე 3.2%",
                brand: "დარიჩინი",
                image: "https://images.unsplash.com/photo-1563636619-e9143da7973b?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80",
                category: "რძის პროდუქტები",
                ingredients: ["რძე", "ვიტამინი D", "ვიტამინი A"],
                goodSides: ["კალციუმის წყარო", "ცილის წყარო", "ვიტამინი D"],
                badSides: ["შეიცავს ლაქტოზას"],
                nutrition: { calories: 65, protein: 3.4, carbs: 4.7, sugar: 4.7, fat: 3.6, salt: 0.1 },
                score: "B",
                alternatives: [
                    { name: "რძე ნაკლები ცხიმით", score: "A", image: "https://images.unsplash.com/photo-1563636619-e9143da7973b?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ბადაგენის რძე", score: "B", image: "https://images.unsplash.com/photo-1563636619-e9143da7973b?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "სოიოს რძე", score: "A", image: "https://images.unsplash.com/photo-1563636619-e9143da7973b?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" }
                ]
            },
            
            // Georgian Bread
            '4860103230019': {
                name: "შოთის პური",
                brand: "შოთის პური",
                image: "https://images.unsplash.com/photo-1509440159596-0249088772ff?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80",
                category: "ცომეული",
                ingredients: ["ფქვილი", "წყალი", "მარილი", "საფუარი"],
                goodSides: ["არ შეიცავს შაქარს", "დაბალი ცხიმი", "მთელი მარცვლეული"],
                badSides: ["მაღალი გლიკემიური ინდექსი"],
                nutrition: { calories: 265, protein: 9, carbs: 49, sugar: 2, fat: 3, salt: 0.5 },
                score: "B",
                alternatives: [
                    { name: "მთელი მარცვლეულის პური", score: "A", image: "https://images.unsplash.com/photo-1509440159596-0249088772ff?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "რუგული პური", score: "A", image: "https://images.unsplash.com/photo-1509440159596-0249088772ff?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "შავი პური", score: "B", image: "https://images.unsplash.com/photo-1509440159596-0249088772ff?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" }
                ]
            },
            
            // Georgian Cheese
            '4860103240018': {
                name: "სულგუნი",
                brand: "ქართული ყველი",
                image: "https://images.unsplash.com/photo-1567174687330-10fbf95c5e63?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80",
                category: "რძის პროდუქტები",
                ingredients: ["რძე", "მარილი", "საფუარის კულტურები"],
                goodSides: ["კალციუმის წყარო", "ცილის წყარო", "ბუნებრივი პროდუქტი"],
                badSides: ["მაღალი მარილი", "მაღალი ცხიმი"],
                nutrition: { calories: 320, protein: 22, carbs: 2, sugar: 1, fat: 25, salt: 1.8 },
                score: "C",
                alternatives: [
                    { name: "იმერული ყველი", score: "B", image: "https://images.unsplash.com/photo-1567174687330-10fbf95c5e63?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ნადუღი", score: "B", image: "https://images.unsplash.com/photo-1567174687330-10fbf95c5e63?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ყველი ნაკლები მარილით", score: "A", image: "https://images.unsplash.com/photo-1567174687330-10fbf95c5e63?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" }
                ]
            },
            
            // Georgian Mineral Water
            '4860103250017': {
                name: "ბორჯომი",
                brand: "ბორჯომი",
                image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80",
                category: "სასმელი",
                ingredients: ["ბუნებრივი მინერალური წყალი"],
                goodSides: ["ბუნებრივი მინერალები", "არ შეიცავს კალორიებს", "დეტოქსიკაცია"],
                badSides: [],
                nutrition: { calories: 0, protein: 0, carbs: 0, sugar: 0, fat: 0, salt: 0.02 },
                score: "A",
                alternatives: [
                    { name: "ნაბეღლავი", score: "A", image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ლიკანი", score: "A", image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ჩირთვის წყალი", score: "A", image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" }
                ]
            },
            
            // Georgian Chocolate
            '4860103260016': {
                name: "ქართული შოკოლადი",
                brand: "გედი",
                image: "https://images.unsplash.com/photo-1575377427642-087cf684f29d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80",
                category: "ტკბილეული",
                ingredients: ["შაქარი", "კაკაოს მასა", "კაკაოს კარაქი", "რძის ფხვნილი", "ემულგატორები"],
                goodSides: ["მცირე რაოდენობით ანტიოქსიდანტები"],
                badSides: ["მაღალი შაქარი", "მაღალი კალორიულობა", "ცხიმიანი"],
                nutrition: { calories: 545, protein: 7, carbs: 60, sugar: 52, fat: 30, salt: 0.2 },
                score: "D",
                alternatives: [
                    { name: "მუშკეტის შოკოლადი", score: "C", image: "https://images.unsplash.com/photo-1575377427642-087cf684f29d?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ბნელი შოკოლადი 70%", score: "B", image: "https://images.unsplash.com/photo-1575377427642-087cf684f29d?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ხილის ნაჭრები", score: "A", image: "https://images.unsplash.com/photo-1575377427642-087cf684f29d?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" }
                ]
            },
            
            // Georgian Wine
            '4860103270015': {
                name: "კინძმარაული",
                brand: "ქართული ღვინო",
                image: "https://images.unsplash.com/photo-1510812431401-41d2bd2722f3?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80",
                category: "ალკოჰოლი",
                ingredients: ["ყურძენი", "საფუარი"],
                goodSides: ["ანტიოქსიდანტები", "რეზვერატროლი"],
                badSides: ["ალკოჰოლი", "კალორიები", "შეიძლება გამოიწვიოს დამოკიდებულება"],
                nutrition: { calories: 125, protein: 0, carbs: 4, sugar: 1, fat: 0, salt: 0 },
                score: "D",
                alternatives: [
                    { name: "წითელი ღვინო (მცირე რაოდენობით)", score: "C", image: "https://images.unsplash.com/photo-1510812431401-41d2bd2722f3?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ყურძნის წვენი", score: "B", image: "https://images.unsplash.com/photo-1510812431401-41d2bd2722f3?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "წყალი ლიმონით", score: "A", image: "https://images.unsplash.com/photo-1510812431401-41d2bd2722f3?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" }
                ]
            },
            
            // Georgian Snacks
            '4860103280014': {
                name: "ჩურჩხელა",
                brand: "ტრადიციული",
                image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80",
                category: "სნექი",
                ingredients: ["ხორბალი", "შაქარი", "თხილი", "თაფლი"],
                goodSides: ["ბუნებრივი ინგრედიენტები", "არ შეიცავს კონსერვანტებს"],
                badSides: ["მაღალი შაქარი", "მაღალი კალორიულობა"],
                nutrition: { calories: 420, protein: 8, carbs: 75, sugar: 45, fat: 12, salt: 0.1 },
                score: "C",
                alternatives: [
                    { name: "ხილის დამშრალი ნაჭრები", score: "A", image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "თხილის მიქსი", score: "B", image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" },
                    { name: "ბოსტნეულის ჩიფსი", score: "A", image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200&q=80" }
                ]
            }
        };
        
        // Initialize audio
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.warn("Web Audio API not supported");
            }
        }
        
        // Play scan sound
        function playScanSound() {
            if (!audioContext) return;
            
            try {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 1000;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
                
                // Visual sound wave
                soundWave.classList.add('active');
                setTimeout(() => soundWave.classList.remove('active'), 500);
            } catch (e) {
                console.warn("Sound error:", e);
            }
        }
        
        // Trigger vibration
        function triggerVibration() {
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100]);
            }
            
            document.querySelector('.scanner-container').classList.add('vibration-effect');
            setTimeout(() => {
                document.querySelector('.scanner-container').classList.remove('vibration-effect');
            }, 300);
        }
        
        // Show scan notification
        function showScanNotification(barcode) {
            scanNotification.innerHTML = `<i class="fas fa-bolt"></i> აღმოჩენილია: ${barcode}`;
            scanNotification.classList.add('show');
            
            setTimeout(() => {
                scanNotification.classList.remove('show');
            }, 2000);
        }
        
        // Start scanner with high quality settings
        async function startScanner() {
            try {
                loadingText.textContent = "კამერის ინიციალიზაცია...";
                loadingOverlay.style.display = 'flex';
                
                initAudio();
                
                // Optimized Quagga settings for high quality scanning
                await Quagga.init({
                    inputStream: {
                        name: "Live",
                        type: "LiveStream",
                        target: document.querySelector('#interactive'),
                        constraints: {
                            width: { min: 1280, ideal: 1920, max: 2560 },
                            height: { min: 720, ideal: 1080, max: 1440 },
                            aspectRatio: { ideal: 16/9 },
                            facingMode: "environment",
                            frameRate: { ideal: 60, max: 60 }
                        },
                        area: {
                            top: "20%",
                            right: "10%",
                            left: "10%",
                            bottom: "20%"
                        }
                    },
                    decoder: {
                        readers: [
                            "ean_reader",
                            "ean_8_reader", 
                            "upc_reader",
                            "upc_e_reader",
                            "code_128_reader",
                            "code_39_reader"
                        ],
                        multiple: false
                    },
                    locate: true,
                    frequency: 60,
                    halfSample: true,
                    patchSize: "large",
                    debug: {
                        drawBoundingBox: false,
                        showFrequency: false,
                        drawScanline: false,
                        showPattern: false
                    }
                }, function(err) {
                    if (err) {
                        console.error("Scanner error:", err);
                        hideLoading();
                        alert("კამერის დაკავშირება ვერ მოხერხდა. გთხოვთ შეამოწმეთ ნებართვები.");
                        return;
                    }
                    
                    Quagga.start();
                    
                    scannerActive = true;
                    scannerStatusText.textContent = "სკანერი მოქმედია";
                    scannerStatusText.parentElement.className = "status-badge";
                    startScannerBtn.disabled = true;
                    stopScannerBtn.disabled = false;
                    
                    hideLoading();
                });
                
                // Instant detection callback
                Quagga.onDetected(function(result) {
                    if (scanCooldown) return;
                    
                    const code = result.codeResult.code;
                    if (code && code !== lastScannedCode) {
                        lastScannedCode = code;
                        scanCooldown = true;
                        currentBarcode = code;
                        
                        // Immediate feedback
                        playScanSound();
                        triggerVibration();
                        showScanNotification(code);
                        
                        // Instant processing
                        processBarcode(code);
                        
                        setTimeout(() => {
                            scanCooldown = false;
                        }, 1000);
                    }
                });
                
            } catch (error) {
                console.error("Scanner start error:", error);
                hideLoading();
                alert("კამერაზე წვდომა ვერ მოხერხდა.");
            }
        }
        
        // Stop scanner
        function stopScanner() {
            if (scannerActive && Quagga) {
                Quagga.stop();
                
                scannerActive = false;
                scannerStatusText.textContent = "სკანერი გამორთულია";
                scannerStatusText.parentElement.className = "status-badge";
                startScannerBtn.disabled = false;
                stopScannerBtn.disabled = true;
            }
        }
        
        // Process barcode - Only Georgian products
        async function processBarcode(barcode) {
            showLoading(`პროდუქტის მოძიება: ${barcode}`);
            
            // Check Georgian products database
            setTimeout(() => {
                if (georgianProducts[barcode]) {
                    displayProduct(georgianProducts[barcode], barcode);
                } else {
                    showProductNotFound(barcode);
                }
            }, 1000);
        }
        
        // Display product with alternatives
        function displayProduct(product, barcode) {
            // Update basic info
            productTitle.textContent = product.name;
            productBrand.textContent = product.brand;
            productImage.src = product.image;
            productImage.alt = product.name;
            barcodeDisplay.textContent = `შეფუთვის კოდი: ${barcode}`;
            
            // Update Nutri-Score
            nutriScore.className = `nutri-score score-${product.score.toLowerCase()}`;
            nutriScore.textContent = product.score;
            updateScoreLabel(product.score);
            
            // Update ingredients
            ingredientsList.innerHTML = '';
            product.ingredients.forEach(ingredient => {
                const li = document.createElement('li');
                li.className = 'ingredient-item';
                const status = getIngredientStatus(ingredient);
                li.innerHTML = `
                    <span>${ingredient}</span>
                    <span class="ingredient-status ${status.class}">${status.text}</span>
                `;
                ingredientsList.appendChild(li);
            });
            
            // Update good sides
            goodSidesList.innerHTML = '';
            product.goodSides.forEach(side => {
                const li = document.createElement('li');
                li.className = 'ingredient-item';
                li.innerHTML = `<span>${side}</span>`;
                goodSidesList.appendChild(li);
            });
            
            // Update bad sides
            badSidesList.innerHTML = '';
            product.badSides.forEach(side => {
                const li = document.createElement('li');
                li.className = 'ingredient-item';
                li.innerHTML = `<span>${side}</span>`;
                badSidesList.appendChild(li);
            });
            
            // Update nutrition
            document.getElementById('caloriesValue').textContent = product.nutrition.calories;
            document.getElementById('proteinValue').textContent = product.nutrition.protein + 'გ';
            document.getElementById('carbsValue').textContent = product.nutrition.carbs + 'გ';
            document.getElementById('fatValue').textContent = product.nutrition.fat + 'გ';
            
            // Update alternatives
            displayAlternatives(product.alternatives);
            
            // Show product info
            productPlaceholder.style.display = 'none';
            productInfo.style.display = 'block';
            
            // Set buy button to search in Georgian stores
            buyProductBtn.onclick = () => {
                const query = encodeURIComponent(`${product.name} ${product.brand} საქართველო`);
                window.open(`https://www.google.com/search?q=${query}+ყიდვა+საქართველოში`, '_blank');
            };
            
            hideLoading();
        }
        
        // Update score label in Georgian
        function updateScoreLabel(score) {
            const labels = {
                "A": "შეფასება: ბევრად უკეთესი",
                "B": "შეფასება: კარგი",
                "C": "შეფასება: საშუალო",
                "D": "შეფასება: ცუდი",
                "E": "შეფასება: ძალიან ცუდი"
            };
            scoreLabel.textContent = labels[score] || "შეფასება: უცნობი";
        }
        
        // Display alternatives
        function displayAlternatives(alternatives) {
            alternativesGrid.innerHTML = '';
            
            alternatives.forEach(alt => {
                const card = document.createElement('div');
                card.className = 'alternative-card';
                card.onclick = () => {
                    // Simulate selecting alternative
                    alert(`არჩეულია: ${alt.name}`);
                };
                
                card.innerHTML = `
                    <div class="alternative-image">
                        <img src="${alt.image}" alt="${alt.name}">
                    </div>
                    <div class="alternative-info">
                        <div class="alternative-name">${alt.name}</div>
                        <div class="alternative-score score-${alt.score.toLowerCase()}">${alt.score}</div>
                    </div>
                `;
                
                alternativesGrid.appendChild(card);
            });
            
            // Show alternatives section
            alternativesSection.style.display = 'block';
        }
        
        // Get ingredient status
        function getIngredientStatus(ingredient) {
            const lower = ingredient.toLowerCase();
            
            if (lower.includes('შაქარი') || lower.includes('სიროფი') || lower.includes('გლუკოზა')) {
                return { class: 'status-bad', text: 'ცუდი' };
            }
            
            if (lower.includes('ბუნებრივი') || lower.includes('ორგანული') || lower.includes('ვიტამინი')) {
                return { class: 'status-excellent', text: 'შესანიშნავი' };
            }
            
            if (lower.includes('რძე') || lower.includes('ცილა') || lower.includes('კალციუმი')) {
                return { class: 'status-good', text: 'კარგი' };
            }
            
            if (lower.includes('მარილი') || lower.includes('ნატრიუმი') || lower.includes('ცხიმი')) {
                return { class: 'status-medium', text: 'საშუალო' };
            }
            
            return { class: 'status-good', text: 'კარგი' };
        }
        
        // Show product not found
        function showProductNotFound(barcode) {
            productPlaceholder.innerHTML = `
                <div class="placeholder-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3 class="placeholder-title">პროდუქტი ვერ მოიძებნა</h3>
                <p class="placeholder-text">შეფუთვის კოდი: ${barcode} ვერ მოიძებნა ქართულ პროდუქტების ბაზაში.</p>
                <p class="placeholder-text">სცადეთ სხვა პროდუქტის სკანირება ან მოძებნეთ ხელით.</p>
                <button class="yuka-button primary" style="margin-top: 20px;" onclick="window.open('https://www.google.com/search?q=პროდუქტი+${barcode}+საქართველო', '_blank')">
                    <i class="fab fa-google"></i> ძიება Google-ზე
                </button>
            `;
            productPlaceholder.style.display = 'flex';
            productInfo.style.display = 'none';
            hideLoading();
        }
        
        // Test scan function
        function testScan() {
            const georgianBarcodes = Object.keys(georgianProducts);
            const randomBarcode = georgianBarcodes[Math.floor(Math.random() * georgianBarcodes.length)];
            
            playScanSound();
            triggerVibration();
            showScanNotification(randomBarcode);
            processBarcode(randomBarcode);
        }
        
        // Show loading
        function showLoading(text) {
            loadingText.textContent = text;
            loadingOverlay.style.display = 'flex';
        }
        
        // Hide loading
        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }
        
        // Event Listeners
        startScannerBtn.addEventListener('click', startScanner);
        stopScannerBtn.addEventListener('click', stopScanner);
        testScanBtn.addEventListener('click', testScan);
        saveProductBtn.addEventListener('click', () => {
            alert('პროდუქტი შენახულია თქვენს ისტორიაში!');
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log("ქართული პროდუქტების სკანერი მზადაა");
            
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                alert("თქვენს ბრაუზერს არ აქვს კამერის მხარდაჭერა. გთხოვთ გამოიყენოთ Chrome, Firefox ან Edge.");
                startScannerBtn.disabled = true;
                startScannerBtn.innerHTML = '<i class="fas fa-times"></i> კამერა არ არის მხარდაჭერილი';
            }
        });
        
        // Cleanup
        window.addEventListener('beforeunload', () => {
            if (scannerActive) {
                stopScanner();
            }
        });
    </script>
</body>
</html>
