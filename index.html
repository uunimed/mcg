<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediClubGeorgia - მორიგეობის გამომუშავება</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Login Page */
        .login-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 350px;
            text-align: center;
            display: block;
        }

        .main-container {
            display: none;
            width: 95%;
            max-width: 1200px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        h1 {
            font-size: 28px;
            color: #333;
            margin-bottom: 20px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }

        .header h2 {
            font-size: 24px;
            font-weight: 600;
        }

        .input-group {
            margin: 20px 0;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .input-group input:focus {
            border-color: #667eea;
            outline: none;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        /* Main Content */
        .content {
            padding: 20px;
        }

        .month-selector {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .month-nav {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-btn {
            background: #667eea;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .current-month {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .other-months-btn {
            background: #764ba2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        /* Earning Panel */
        .earning-panel {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .total-earning {
            font-size: 32px;
            font-weight: 700;
        }

        .insurance-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
        }

        .insurance-toggle.active {
            background: rgba(255,255,255,0.4);
        }

        /* Table */
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #e0e0e0;
        }

        td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
        }

        .type-header {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        .date-cell {
            font-weight: 600;
            color: #333;
            background: #f8f9fa;
        }

        input[type="number"] {
            width: 80px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 6px;
            text-align: center;
            font-size: 14px;
        }

        input[type="number"]:focus {
            border-color: #667eea;
            outline: none;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h3 {
            font-size: 24px;
            color: #333;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .month-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .month-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s;
            text-align: center;
        }

        .month-card:hover {
            transform: translateY(-5px);
            background: #e9ecef;
        }

        .month-card h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .month-card .amount {
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
        }

        /* Popup */
        .popup {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            animation: slideIn 0.3s ease-out;
            display: none;
        }

        .popup.success {
            background: linear-gradient(135deg, #4cd964 0%, #5ac8fa 100%);
        }

        .popup.error {
            background: linear-gradient(135deg, #ff2d55 0%, #ff9500 100%);
        }

        .popup.info {
            background: linear-gradient(135deg, #5ac8fa 0%, #007aff 100%);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Logout */
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }

        /* Footer */
        .prices-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 14px;
            color: #666;
        }

        .price-item {
            display: inline-block;
            margin-right: 20px;
        }

        .price-item i {
            margin-right: 5px;
            color: #667eea;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-container" id="loginPage">
        <div style="margin-bottom: 30px;">
            <i class="fas fa-user-md" style="font-size: 48px; color: #667eea;"></i>
        </div>
        <h1>MediClubGeorgia</h1>
        <p style="color: #666; margin-bottom: 30px;">გთხოვთ შეიყვანოთ მონაცემები</p>
        
        <div class="input-group">
            <label for="username">მომხმარებელი</label>
            <input type="text" id="username" placeholder="შეიყვანეთ მომხმარებლის სახელი">
        </div>
        
        <div class="input-group">
            <label for="password">პაროლი</label>
            <input type="password" id="password" placeholder="შეიყვანეთ პაროლი">
        </div>
        
        <button class="btn" onclick="login()">
            <i class="fas fa-sign-in-alt"></i> შესვლა
        </button>
    </div>

    <!-- Main App -->
    <div class="main-container" id="mainApp">
        <button class="logout-btn" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> გასვლა
        </button>

        <div class="header">
            <h2>MediClubGeorgia-ში მუშაობის დროს ყოველთვიურად გამომუშავებული ხელფასის რაოდენობა</h2>
        </div>

        <div class="content">
            <!-- Month Selector -->
            <div class="month-selector">
                <div class="month-nav">
                    <button class="nav-btn" onclick="changeMonth(-1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="current-month" id="currentMonth">სექტემბერი 2024</div>
                    <button class="nav-btn" onclick="changeMonth(1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <button class="other-months-btn" onclick="showOtherMonths()">
                    <i class="fas fa-calendar-alt"></i> სხვა თვეების დათვალიერება
                </button>
            </div>

            <!-- Earning Panel -->
            <div class="earning-panel">
                <div>
                    <div style="font-size: 14px; opacity: 0.9;">მთლიანი გამომუშავება</div>
                    <div class="total-earning" id="totalEarning">0.00 ₾</div>
                </div>
                <div class="insurance-toggle" id="insuranceToggle" onclick="toggleInsurance()">
                    <i class="fas fa-shield-alt"></i>
                    <span>დაზღვევა</span>
                </div>
            </div>

            <!-- Main Table -->
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th class="type-header">თარიღი</th>
                            <th class="type-header">მორიგეობა (საათები)</th>
                            <th class="type-header">ობსერვაცია</th>
                            <th class="type-header">ჰემოტრანსფუზია</th>
                            <th class="type-header">დღის სტაციონარი</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Table rows will be generated here -->
                    </tbody>
                </table>
            </div>

            <!-- Prices Info -->
            <div class="prices-info">
                <div class="price-item">
                    <i class="fas fa-clock"></i> 1 საათი მორიგეობა = 5.84 ₾
                </div>
                <div class="price-item">
                    <i class="fas fa-eye"></i> 1 ობსერვაცია = 7 ₾
                </div>
                <div class="price-item">
                    <i class="fas fa-tint"></i> 1 ჰემოტრანსფუზია = 5 ₾
                </div>
                <div class="price-item">
                    <i class="fas fa-bed"></i> 1 დღის სტაციონარი = 10 ₾
                </div>
            </div>
        </div>
    </div>

    <!-- Other Months Modal -->
    <div class="modal" id="otherMonthsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>სხვა თვეების დათვალიერება</h3>
                <button class="close-modal" onclick="closeOtherMonths()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="month-grid" id="monthsGrid">
                <!-- Month cards will be generated here -->
            </div>
        </div>
    </div>

    <!-- Popup -->
    <div class="popup" id="popup"></div>

    <script>
        // User credentials
        const USERNAME = "alex";
        const PASSWORD = "2911";

        // Current date
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();
        let insuranceActive = false;
        let monthlyData = {};
        let allMonthsData = {};

        // Georgian month names
        const georgianMonths = [
            "იანვარი", "თებერვალი", "მარტი", "აპრილი", "მაისი", "ივნისი",
            "ივლისი", "აგვისტო", "სექტემბერი", "ოქტომბერი", "ნოემბერი", "დეკემბერი"
        ];

        // Login function
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === USERNAME && password === PASSWORD) {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                loadData();
                updateTable();
                showPopup("მოგესალმებით, ალექს!", "success");
            } else {
                showPopup("არასწორი მომხმარებელი ან პაროლი!", "error");
            }
        }

        // Logout function
        function logout() {
            document.getElementById('loginPage').style.display = 'block';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        // Show popup message
        function showPopup(message, type = "info") {
            const popup = document.getElementById('popup');
            popup.textContent = message;
            popup.className = `popup ${type}`;
            popup.style.display = 'block';
            
            setTimeout(() => {
                popup.style.display = 'none';
            }, 3000);
        }

        // Change month
        function changeMonth(direction) {
            currentMonth += direction;
            
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            
            updateMonthDisplay();
            updateTable();
        }

        // Update month display
        function updateMonthDisplay() {
            const monthName = georgianMonths[currentMonth];
            document.getElementById('currentMonth').textContent = `${monthName} ${currentYear}`;
        }

        // Toggle insurance
        function toggleInsurance() {
            insuranceActive = !insuranceActive;
            const toggle = document.getElementById('insuranceToggle');
            
            if (insuranceActive) {
                toggle.classList.add('active');
                showPopup("დაზღვევა აქტიურია (-100 ₾)", "info");
            } else {
                toggle.classList.remove('active');
                showPopup("დაზღვევა არააქტიურია", "info");
            }
            
            calculateTotal();
        }

        // Calculate total earning
        function calculateTotal() {
            let total = 0;
            const rows = document.querySelectorAll('#tableBody tr');
            
            rows.forEach(row => {
                const dutyHours = parseFloat(row.querySelector('.duty-hours').value) || 0;
                const observations = parseFloat(row.querySelector('.observations').value) || 0;
                const transfusions = parseFloat(row.querySelector('.transfusions').value) || 0;
                const dayStationary = parseFloat(row.querySelector('.day-stationary').value) || 0;
                
                total += (dutyHours * 5.84) + (observations * 7) + (transfusions * 5) + (dayStationary * 10);
            });
            
            if (insuranceActive) {
                total -= 100;
            }
            
            document.getElementById('totalEarning').textContent = total.toFixed(2) + ' ₾';
            saveData();
        }

        // Update table for current month
        function updateTable() {
            const monthKey = `${currentYear}-${currentMonth}`;
            
            if (!monthlyData[monthKey]) {
                monthlyData[monthKey] = {};
            }
            
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dayKey = day.toString();
                const dayData = monthlyData[monthKey][dayKey] || { duty: 0, obs: 0, trans: 0, station: 0 };
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="date-cell">${day}</td>
                    <td>
                        <input type="number" min="0" step="0.5" value="${dayData.duty}" 
                               class="duty-hours" onchange="updateDayData(${day}, 'duty', this.value)">
                    </td>
                    <td>
                        <input type="number" min="0" value="${dayData.obs}" 
                               class="observations" onchange="updateDayData(${day}, 'obs', this.value)">
                    </td>
                    <td>
                        <input type="number" min="0" value="${dayData.trans}" 
                               class="transfusions" onchange="updateDayData(${day}, 'trans', this.value)">
                    </td>
                    <td>
                        <input type="number" min="0" value="${dayData.station}" 
                               class="day-stationary" onchange="updateDayData(${day}, 'station', this.value)">
                    </td>
                `;
                tableBody.appendChild(row);
            }
            
            updateMonthDisplay();
            calculateTotal();
        }

        // Update day data
        function updateDayData(day, type, value) {
            const monthKey = `${currentYear}-${currentMonth}`;
            
            if (!monthlyData[monthKey]) {
                monthlyData[monthKey] = {};
            }
            
            if (!monthlyData[monthKey][day]) {
                monthlyData[monthKey][day] = { duty: 0, obs: 0, trans: 0, station: 0 };
            }
            
            monthlyData[monthKey][day][type] = parseFloat(value) || 0;
            calculateTotal();
        }

        // Show other months modal
        function showOtherMonths() {
            const monthsGrid = document.getElementById('monthsGrid');
            monthsGrid.innerHTML = '';
            
            // Generate data for all months if not exists
            for (let year = 2024; year <= currentYear; year++) {
                for (let month = 0; month < 12; month++) {
                    if (year === currentYear && month > currentMonth) break;
                    
                    const monthKey = `${year}-${month}`;
                    let total = 0;
                    
                    if (monthlyData[monthKey]) {
                        Object.values(monthlyData[monthKey]).forEach(dayData => {
                            total += (dayData.duty * 5.84) + (dayData.obs * 7) + 
                                    (dayData.trans * 5) + (dayData.station * 10);
                        });
                    }
                    
                    if (total > 0) {
                        const monthCard = document.createElement('div');
                        monthCard.className = 'month-card';
                        monthCard.innerHTML = `
                            <h4>${georgianMonths[month]} ${year}</h4>
                            <div class="amount">${total.toFixed(2)} ₾</div>
                        `;
                        monthCard.onclick = () => {
                            currentMonth = month;
                            currentYear = year;
                            updateTable();
                            closeOtherMonths();
                            showPopup(`${georgianMonths[month]} ${year} იხილება`, "info");
                        };
                        monthsGrid.appendChild(monthCard);
                    }
                }
            }
            
            if (monthsGrid.children.length === 0) {
                monthsGrid.innerHTML = '<p style="color: #666; text-align: center; width: 100%;">სხვა თვეების მონაცემები ჯერ არ არის შენახული</p>';
            }
            
            document.getElementById('otherMonthsModal').style.display = 'flex';
        }

        // Close other months modal
        function closeOtherMonths() {
            document.getElementById('otherMonthsModal').style.display = 'none';
        }

        // Save data to localStorage
        function saveData() {
            const data = {
                monthlyData: monthlyData,
                insuranceActive: insuranceActive,
                currentMonth: currentMonth,
                currentYear: currentYear
            };
            localStorage.setItem('mediClubData', JSON.stringify(data));
        }

        // Load data from localStorage
        function loadData() {
            const savedData = localStorage.getItem('mediClubData');
            if (savedData) {
                const data = JSON.parse(savedData);
                monthlyData = data.monthlyData || {};
                insuranceActive = data.insuranceActive || false;
                currentMonth = data.currentMonth || currentDate.getMonth();
                currentYear = data.currentYear || currentDate.getFullYear();
                
                // Update insurance toggle
                if (insuranceActive) {
                    document.getElementById('insuranceToggle').classList.add('active');
                }
            }
        }

        // Initialize
        window.onload = function() {
            updateMonthDisplay();
            
            // Add event listener for Enter key in login
            document.getElementById('password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
        };
    </script>
</body>
</html>
